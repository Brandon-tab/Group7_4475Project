```{r}
require(tidyverse)
require(data.table)
require(randomForest)
require(mclust)
require(rpart)
require(rpart.plot)
require(foreign)
require(e1071)
```
Selection
#Data Source
#https://www.kaggle.com/datasets/whenamancodes/credit-card-customers-prediction

Pre-processing
```{r}
require(stringr)
require(sqldf)

data <- read.csv('BankChurners.csv')

missing_data<-is.na(data)

missing_df<-as.data.frame(missing_data)

missing_df

```

Excellent: 0-10% utilization
Good: 10-30% utilization
Fair: 30-50% utilization
Poor: 50% or higher utilization
Transformation
```{r}
Transform <- data

Transform$Util_Rank<-sapply(Transform$Avg_Utilization_Ratio,function(x){
 if (x <0.1 ){
   return('Excellent')
 }else if (x<0.3){
   return('Good')
 }else if (x<0.5){
   return('Fair')
 }else{
   return('Poor')
 }  
})


column_to_move <- "Util_Rank" 
target_column <- "Avg_Utilization_Ratio" 


target_position <- match(target_column, names(Transform)) + 1  


new_order <- c(names(Transform)[1:(target_position - 1)], 
               column_to_move, 
               names(Transform)[target_position:length(names(Transform))])


Transform <- Transform[, new_order]
Transform$Util_Rank.1<-NULL
Transform

```

Descriptive Analysis
Question1 - Basic Aggregration
```{r}
#Summarise the average credit limit by different card type
Credit_Average<-tapply(Transform$Credit_Limit, Transform$Card_Category, mean)
Credit_Average_df<-as.data.frame(Credit_Average)
Credit_Average_df

#count the number of different education level

Education_Count<-tapply(Transform$Education_Level, Transform$Education_Level, length)
Education_Count_df<-as.data.frame(Education_Count)
Education_Count_df

#Summaries Average of Open to buy all Income Category

Open_to_buy_Average<-tapply(Transform$Avg_Open_To_Buy, Transform$Income_Category, mean)
Open_to_buy_Average_df<-as.data.frame(Open_to_buy_Average)
Open_to_buy_Average_df
```

Question2 - Basic statics (Bar)
```{r}

barplot(Open_to_buy_Average_df$Open_to_buy_Average,  
        names.arg = rownames(Open_to_buy_Average_df)
        
        ) 


```

Question3 - Basic statics (pie)
```{r}

pie(Education_Count_df$Education_Count,
    labels = rownames(Education_Count_df),
   )


```

Question4 - Relation(scatter)
```{r}

```

https://www.digitalocean.com/community/tutorials/normalize-data-in-r
https://stats.stackexchange.com/questions/298507/mclust-model-names-corresponding-to-common-models-i-e-those-used-for-lpa-lc
Modelname EEE = Equal variances and equal covariances
if you want to make the clustering like a matrix, try to use modelname EEE
Question5 - Clustering
```{r}

```

Question6 - pattern finding(CART tree)
```{r}

rpart.plot(Tree)
```

Question7 - classification(Naive Bias)
```{r}
#NB Classification


#new customers


#make an enquiry
predict()
```

Question8 - Prediction/simulation (random Forest)
```{r}
#model building


#model testing

#new customer


#choose one row data for testing
predict()
```

Evualtion
#Write you finding in Report, Thanks!
